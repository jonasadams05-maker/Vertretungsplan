<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<title>Vertretungsplan Firebase Version</title>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
  import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-database.js";
  import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyA_F6z1Ujx4j7qDE7MC-3zoc2v_6nttzfI",
    authDomain: "vertretungsplan-schule-638ad.firebaseapp.com",
    databaseURL: "https://vertretungsplan-schule-638ad-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "vertretungsplan-schule-638ad",
    storageBucket: "vertretungsplan-schule-638ad.firebasestorage.app",
    messagingSenderId: "747883633270",
    appId: "1:747883633270:web:0dcb4b2067ff5543f09d57",
    measurementId: "G-69JC200Y6N"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const auth = getAuth(app);

  function savePlan() {
    const txt = document.getElementById('plan').value;
    set(ref(db, 'plan'), { content: txt });
  }

  onValue(ref(db, 'plan'), snap => {
    const val = snap.val();
    if(val) document.getElementById('plan').value = val.content;
  });

  function login() {
    const email = document.getElementById('email').value;
    const pw = document.getElementById('pw').value;
    signInWithEmailAndPassword(auth, email, pw).catch(alert);
  }

  onAuthStateChanged(auth, user => {
    document.getElementById('admin').style.display = user ? 'block' : 'none';
  });
</script>
</head>
<body>
<h1>Vertretungsplan â€“ Live</h1>
<textarea id="plan" style="width:100%;height:300px;"></textarea>

<div id="admin" style="display:none;margin-top:10px;">
  <button onclick="savePlan()">Speichern (Admin)</button>
</div>

<h3>Admin Login</h3>
<input id="email" placeholder="Email"><br>
<input id="pw" placeholder="Passwort" type="password"><br>
<button onclick="login()">Login</button>

</body>
</html>
